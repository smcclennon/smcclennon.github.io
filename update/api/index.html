<!DOCTYPE html>
<link rel="icon" href="../../assets/images/smcclennon.png">
<link rel="stylesheet" type="text/css" href="../../assets/css/cayman.css">
<link rel="stylesheet" type="text/css" href="../../assets/css/normalize.css">
<head>
    <title>About My API</title>
  </head>
<body data-gr-c-s-loaded="true">

  <header class="page-header" role="banner">
    <h1 class="project-name">API</h1>
    <h2 class="project-tagline">About my API & what it's used for</h2>
      <a href="../../" class="btn">Home</a>
      <a href="../../projects" class="btn">Projects</a>
  </header>

  <main id="content" class="main-content" role="main">
    <h2 id="header-2">About My API</h1>
    <p>I created a small API which consists of links to various GitHub API pages for my respective projects. Projects with update support will use this API to get the information they need to update (such as patch notes and a download link).</p>
    <p>Information within the API pages may seem to be in a rather haphazard order, and that is because it is. I cannot adjust the order, as this would break the update code on projects using this API.</p>
    <p>The API pages will appear to have all information on the same line, separated by spaces. This is due to how GitHub.io displays unformatted html.</p>

    <h3 id="header-3">API Format</h1>
    <p>This is the information that goes on the respective (numbered) line</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
    <code>1. Latest release details [URL, Json]
    2. Project name [String]
    3. Latest release direct download link [URL, Json]
    4. 5 latest release details [URL, Json]
    </code></pre></div></div>

    <h3 id="header-3">Information Use</h3>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
    <code>1. Display the latest version [e.g v1.2.3]
    2. Update the current project name [backwards compatibility]
    3. Download the latest release
    4. Display up to 5 previous release patch notes
    </code></pre></div></div>

    <h1 id="header-1">API List</h1>
    <p>List of my API-supported projects</p>
    <table>
      <thead>
        <tr>
          <th style="text-align: center">ID</th>
          <th style="text-align: left">Project</th>
          <th style="text-align: left">Version</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align: left"><a target="_blank" rel="noopener noreferrer" href="1">1</a></td>
          <td style="text-align: left"><a href="https://github.com/smcclennon/LTFO">LTFO</a></td>
          <td style="text-align: left">Up to date</td>
        </tr>
        <tr>
          <td style="text-align: left"><a target="_blank" rel="noopener noreferrer" href="2">2</a></td>
          <td style="text-align: left"><a href="https://github.com/smcclennon/SMN">SMN</a></td>
          <td style="text-align: left">Outdated</td>
        </tr>
      </tbody>
    </table>

    <h3 id="header-3">LTFO's use of the API</h1>
    <link rel="stylesheet" type="text/css" href="../../assets/css/all-hallows-eve.css">
    <script src="../../assets/js/rainbow-python.js"></script>
    <pre><code data-language="python">updateAttempt = 0
print('Checking for updates...', end='\r')
try:  # Remove previous version if just updated
    proj = options['proj']
    with open(f'{proj}.tmp', 'r') as content_file:
        oldFile = str(content_file.read())
        # If the old version has the current filename, don't delete
        if oldFile != os.path.basename(__file__):
            os.remove(oldFile)
    os.remove(f'{proj}.tmp')
except:
    pass
while updateAttempt < 3:
    updateAttempt = updateAttempt+1
    try:
        with urllib.request.urlopen("https://smcclennon.github.io/update/api/1") as url:
            repo = []
            for line in url.readlines():
                repo.append(line.decode().strip())
            apiLatest = repo[0]  # Latest release details
            proj = repo[1]  # Project name
            ddl = repo[2]  # Direct download
            apiReleases = repo[3]  # List of patch notes
        with urllib.request.urlopen(apiLatest) as url:
            data = json.loads(url.read().decode())
            latest = data['tag_name'][1:]
        del data  # Prevent overlapping variable data
        release = json.loads(urllib.request.urlopen(
            apiReleases).read().decode())
        releases = [
            (data['tag_name'], data['body'])
            for data in release
            if data['tag_name'] > ver][::-1]
        updateAttempt = 3
    except:
        latest = '0'
if latest > ver:
    print('Update available!      ')
    print(f'Latest Version: v{latest}\n')
    for release in releases:
        print(f'{release[0]}:\n{release[1]}\n')
    confirm = input(str('Update now? [Y/n] ')).upper()
    if confirm == '' or confirm == 'Y':
        latestFilename = f'{proj} v{latest}.py'
        # Download latest version to cwd
        print(f'Downloading "{latestFilename}"...')
        urllib.request.urlretrieve(ddl, latestFilename)
        # Write the current filename to LTFO.tmp
        f = open(f'{proj}.tmp', 'w')
        f.write(str(os.path.basename(__file__)))
        f.close()
        os.system(f'"{latestFilename}"')  # Open latest version in the current console window</code></pre>

    <footer class="site-footer">
      <span class="site-footer-credits">Visit my <a href="https://github.com/smcclennon">GitHub page</a></span>
    </footer>
  </main>
</body>